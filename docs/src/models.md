# Discuit.jl models

The following pre defined models can be invoked by ADD FUNCTION...

## Model builder

Pre defined models:

<!-- ```@docs
generate_model(model_name::String, initial_condition::Array{Int64, 1}, obs_error::AbstractFloat = 2.0)
``` -->

### Defaults

[Discuit.jl models](@ref) are `mutable struct`s so it is convenient to generate pre defined with default values for most things and allow the user to overwrite as required. Only the model name and `initial_condition` are required to call ADD XREF. The following gives an overview of important defaults that the user should note before proceeding with their analysis.

#### Observation function

The default `model.obs_function` is YET TO BE DETERMINED...

#### Observation likelihood model

The default `model.obs_model` is YET TO BE DETERMINED...

#### Prior density function

The default `model.prior` density function is weak, e.g. in a simple two parameter model it is equivalent to:

    function weak_prior(parameters::Array{Float64, 1})
        parameters[1] > 0.0 || return 0.0
        parameters[2] > 0.0 || return 0.0
        return 1.0
    end

Note that all models generated by the ADD XREF have `t0_index = 0` by default and that changing this parameter will likely require replacing the the density with something like:

    function weak_prior(parameters::Array{Float64, 1})
        parameters[1] > 0.0 || return 0.0
        parameters[2] > 0.0 || return 0.0
        parameters[3] < 0.0 || return 0.0
        return 1.0
    end

where `parameters[3]` is designated as the, e.g. initial infection, which is assumed to have taken place prior to e.g. the initial observation at t = 0.0. ADD LATEX...

## Classic Kermack-McKendrick models

### SI

The susceptible-infectious (`"SI"`) is a very basic model with only one type of event. Individuals who become infected remain infected for the duration of trajectory.

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/si.png" alt="SI model" height="120"/>
```

### SIR

The classic Kermack-McKendrick susceptible-infectious-recovered (`"SIR"`) model.

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sir.png" alt="SIR model" height="120"/>
```

### SIS

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sis.png" alt="SIS model" height="140"/>
```

The susceptible-infectious-susceptible (`"SIS"`) model is an extension of the classic Kermack-McKendrick ([SIR](@ref)) model for diseases which do not confer lasting immunity.

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sis_sim.png" alt="SIS simulation" height="140"/>
```

### SIRS

The susceptible-infectious-recovered-susceptible (`"SIRS"`) model incorporates all of the above, i.e. it is for diseases which do not confer long lasting immunity.

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sirs.png" alt="SIRS model" height="140"/>
```

## Latent Kermack-McKendrick models

The next class of models extend the classic Kermack-McKendrick by accounting for an exposed state `E` between infection and the onset of infectiousness.

### SEI

The susceptible-exposed-infectious (`"SEI"` model.

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sei.png" alt="SEI model" height="100"/>
```

### SEIR

```@raw html
<img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/seir.png" alt="SEIR model" height="100"/>
```

### SEIS

### SEIRS

## Miscellaneous

### Lotka-Volterra predator-prey model

The Lotka-Volterra model is well known for its application to predator-prey interactions but can also be used to model chemical, bio molecular and other auto regulating biological systems. Compartments are labelled Predator, pRey. The `model.rate_function` for prey reproduction, predator reproduction and predator death is defined as:

    function lotka_rf(output, parameters::Array{Float64, 1}, population::Array{Int64, 1})
      # prey; predator reproduction; predator death
      output[1] = parameters[1] * population[2]
      output[2] = parameters[2] * population[1] * population[2]
      output[3] = parameters[3] * population[1]
    end

with the transition matrix given as:

    m_transition = [ 0 1; 1 -1; -1  0 ]

### Ross-MacDonald predator-prey model

### SETIR model for bTB

## References

```@raw html
<html>
<head>
</head>
<body>
<textarea id="bibtex_input" style="display:none;">
@article{pizza2000identification,
  title={Identification of vaccine candidates against serogroup B meningococcus by whole-genome sequencing},
  author={Pizza, Mariagrazia and Scarlato, Vincenzo and Masignani, Vega and Giuliani, Marzia Monica and Arico, Beatrice and Comanducci, Maurizio and Jennings, Gary T and Baldi, Lucia and Bartolini, Erika and Capecchi, Barbara and others},
  journal={Science},
  volume={287},
  number={5459},
  pages={1816--1820},
  year={2000},
  publisher={American Association for the Advancement of Science}
}
@book{book1,
  author = "Donald Knuth",
  title = "Concrete Mathematics"
}
</textarea>
<div id="bibtex_display"></div>
</body>
</html>
```
