<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Martin Burke">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Models - Discuit.jl</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../assets/Documenter.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Discuit.jl</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Introduction</a>
                    </li>
                    <li >
                        <a href="../examples/">Examples</a>
                    </li>
                    <li class="active">
                        <a href="./">Models</a>
                    </li>
                    <li >
                        <a href="../manual/">Manual</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../examples/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../manual/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/mjb3/Discuit.jl/edit/master/docs/models.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#discuitjl-models">Discuit.jl models</a></li>
            <li><a href="#generating-models">Generating models</a></li>
            <li><a href="#standard-kermack-mckendrick-models">Standard Kermack-McKendrick models</a></li>
            <li><a href="#latent-kermack-mckendrick-models">Latent Kermack-McKendrick models</a></li>
            <li><a href="#miscellaneous">Miscellaneous</a></li>
            <li><a href="#more-information">More information</a></li>
            <li><a href="#references">References</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a id='Discuit.jl-models-1'></a></p>
<h1 id="discuitjl-models">Discuit.jl models</h1>
<p>This section describes the library of predefined models in Discuit. Models can also be user defined, or generated and modified according to need. The models included are mostly epidemiological (see <a href="./#Miscellaneous-1">Miscellaneous</a> for other types of model). The next section described the model generating function and an overview of default model components.</p>
<p><a id='Generating-models-1'></a></p>
<h2 id="generating-models">Generating models</h2>
<p>Pre defined models can be invoked by calling:</p>
<pre class="codehilite"><code>generate_model(model_name, initial_condition, σ = 2.0)</code></pre>


<p><strong> Examples </strong></p>
<pre class="codehilite"><code>model = generate_model(&quot;SIS&quot;, [100, 1]]);
model = generate_model(&quot;SEIR&quot;, [100, 0, 1, 0]], 1.0)</code></pre>


<p><a id='Defaults-1'></a></p>
<h3 id="defaults">Defaults</h3>
<p><a href="./#Discuit.jl-models-1">Discuit.jl models</a> are <code>mutable struct</code>s so it is convenient to generate pre defined with default values for most things and allow the user to overwrite as required. Only the 'model*name' and <code>initial*condition</code>are required to call<code>generate_model</code>. The following gives an overview of important defaults that the user should note before proceeding with their analysis.</p>
<p><a id='Observation-function-1'></a></p>
<h4 id="observation-function">Observation function</h4>
<p>The default <code>model.obs_function</code> returns a vector representing the state of the system at obsertion time $t_y$, i.e.:</p>
<pre class="codehilite"><code>obs_fn(population::Array{Int64, 1}) = population</code></pre>


<p><a id='Observation-likelihood-model-1'></a></p>
<h4 id="observation-likelihood-model">Observation likelihood model</h4>
<p>The default <code>model.observation_model</code> is Gaussian with observation error <code>σ = 2.0</code> by default, which can be changed by providing an optional third parameter to <code>generate_model</code> per the example above,</p>
<p>ADD latex.</p>
<p><a id='Prior-density-function-1'></a></p>
<h4 id="prior-density-function">Prior density function</h4>
<p>The default <code>model.prior</code> density function is weak, e.g. in a simple two parameter model it is equivalent to:</p>
<pre class="codehilite"><code>function weak_prior(parameters::Array{Float64, 1})
    parameters[1] &gt; 0.0 || return 0.0
    parameters[2] &gt; 0.0 || return 0.0
    return 1.0
end</code></pre>


<p>Note that all models generated by the ADD XREF have <code>t0_index = 0</code> by default and that changing this parameter will likely require replacing the the density with something like:</p>
<pre class="codehilite"><code>function weak_prior(parameters::Array{Float64, 1})
    parameters[1] &gt; 0.0 || return 0.0
    parameters[2] &gt; 0.0 || return 0.0
    parameters[3] &lt; 0.0 || return 0.0
    return 1.0
end</code></pre>


<p>where <code>parameters[3]</code> is designated as the, e.g. initial infection, which is assumed to have taken place prior to e.g. the initial observation at t = 0.0.</p>
<p><a id='Standard-Kermack-McKendrick-models-1'></a></p>
<h2 id="standard-kermack-mckendrick-models">Standard Kermack-McKendrick models</h2>
<p>The standard Kermack-McKendrick SIR model can be used to model diseases which confer lasting immunity or situations where infected individuals have been detected and quarantined for treatment (Kermack and McKendrick, 1991). ADD REF: kermack<em>contributions</em>1991</p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SI&quot;, [100, 1])</code></pre>


<p>The susceptible-infectious (<code>"SI"</code>) is a very basic model with only one type of event. Individuals who become infected remain infected for the duration of trajectory.</p>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/si.png" alt="SI model" height="120"/></p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SIR&quot;, [100, 1, 0])</code></pre>


<p>The classic Kermack-McKendrick susceptible-infectious-recovered (<code>"SIR"</code>) model.</p>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sir.png" alt="SIR model" height="120"/></p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SIS&quot;, [100, 1])</code></pre>


<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sis.png" alt="SIS model" height="140"/></p>
<p>The susceptible-infectious-susceptible (<code>"SIS"</code>) model is an extension of the classic Kermack-McKendrick (<a href="../@ref">SIR</a>) model for diseases which do not confer lasting immunity.</p>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sis_sim.png" alt="SIS simulation" height="140"/></p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SIRS&quot;, [100, 1, 0])</code></pre>


<p>The susceptible-infectious-recovered-susceptible (<code>"SIRS"</code>) model incorporates all of the above, i.e. it is for diseases which do not confer long lasting immunity.</p>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sirs.png" alt="SIRS model" height="140"/></p>
<p><a id='Latent-Kermack-McKendrick-models-1'></a></p>
<h2 id="latent-kermack-mckendrick-models">Latent Kermack-McKendrick models</h2>
<p>The next class of models extend the classic Kermack-McKendrick by accounting for an exposed state <code>E</code> between infection and the onset of infectiousness. For example, the susceptible-exposed-infectious <code>SEI</code> model;</p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SEI&quot;, [100, 1, 0])</code></pre>


<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/sei.png" alt="SEI model" height="100"/></p>
<p>A notable extension of the <code>SEI</code> model is the <code>SEIR</code>:</p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SEIR&quot;, [100, 1, 0, 0])</code></pre>


<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/seir.png" alt="SEIR model" height="100"/></p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SEIS&quot;, [100, 1, 0, 0])</code></pre>


<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/seis.png" alt="SEIR model" height="100"/></p>
<pre class="codehilite"><code>Discuit.generate_model(&quot;SEIS&quot;, [100, 1, 0, 0])</code></pre>


<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/seirs.png" alt="SEIR model" height="100"/></p>
<p><a id='Miscellaneous-1'></a></p>
<h2 id="miscellaneous">Miscellaneous</h2>
<p><a id='Lotka-Volterra-predator-prey-model-1'></a></p>
<h3 id="lotka-volterra-predator-prey-model">Lotka-Volterra predator-prey model</h3>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/lotka.png" alt="SEIR model" height="100"/></p>
<p>The Lotka-Volterra model is well known for its application to predator-prey interactions but can also be used to model chemical, bio molecular and other auto regulating biological systems. Compartments are labelled Predator, pRey. The <code>model.rate_function</code> for prey reproduction, predator reproduction and predator death is defined as:</p>
<pre class="codehilite"><code>function lotka_rf(output, parameters::Array{Float64, 1}, population::Array{Int64, 1})
  # prey; predator reproduction; predator death
  output[1] = parameters[1] * population[2]
  output[2] = parameters[2] * population[1] * population[2]
  output[3] = parameters[3] * population[1]
end</code></pre>


<p>with the transition matrix given as:</p>
<pre class="codehilite"><code>m_transition = [ 0 1; 1 -1; -1  0 ]</code></pre>


<p><a id='Ross-MacDonald-malaria-model-1'></a></p>
<h3 id="ross-macdonald-malaria-model">Ross-MacDonald malaria model</h3>
<p>The Ross-MacDonald malaria model is an extension of the Kermack-McKendrick SIS model which accounts for two species, human and mosquito. ADD CITATION. This example is simplified in two ways...</p>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/rossmac.png" alt="Ross-MacDonald malaria model" height="240"/></p>
<p><a id='SETIR-model-for-bTB-1'></a></p>
<h3 id="setir-model-for-btb">SETIR model for bTB</h3>
<p><img src="https://raw.githubusercontent.com/mjb3/Discuit.jl/master/docs/img/setir.png" alt="SETIR model" height="120"/></p>
<p><a id='More-information-1'></a></p>
<h2 id="more-information">More information</h2>
<p>ADD list...</p>
<p>[Compartmental models in epidemiology](https://en.wikipedia.org/wiki/Compartmental<em>models</em>in_epidemiology] (Wiki).</p>
<p><a id='References-1'></a></p>
<h2 id="references">References</h2>
<p><html>
<head>
<script type="text/javascript" src="https://cdn.rawgit.com/pcooksey/bibtex-js/ef59e62c/src/bibtex_js.js"></script>
</head>
<body>
<textarea id="bibtex_input" style="display:none;">
@article{kermack_contributions_1991,
    title = {Contributions to the mathematical theory of epidemics—{I}},
    volume = {53},
    number = {1-2},
    journal = {Bulletin of mathematical biology},
    author = {Kermack, William O. and McKendrick, Anderson G.},
    year = {1991},
    pages = {33--55}
}
@article{pooley_using_2015,
    title = {Using model-based proposals for fast parameter inference on discrete state space, continuous-time {Markov} processes},
    volume = {12},
    issn = {1742-5689, 1742-5662},
    url = {http://rsif.royalsocietypublishing.org/cgi/doi/10.1098/rsif.2015.0225},
    doi = {10.1098/rsif.2015.0225},
    language = {en},
    number = {107},
    urldate = {2017-02-20},
    journal = {Journal of The Royal Society Interface},
    author = {Pooley, C. M. and Bishop, S. C. and Marion, G.},
    month = may,
    year = {2015},
    pages = {20150225--20150225}
}
@article{berryman_orgins_1992,
    title = {The {Orgins} and {Evolution} of {Predator}-{Prey} {Theory}},
    volume = {73},
    issn = {00129658},
    url = {http://doi.wiley.com/10.2307/1940005},
    doi = {10.2307/1940005},
    language = {en},
    number = {5},
    urldate = {2018-03-12},
    journal = {Ecology},
    author = {Berryman, Alan A.},
    month = oct,
    year = {1992},
    pages = {1530--1535}
}
@article{macdonald_analysis_1952,
    title = {The analysis of equilibrium in malaria},
    volume = {49},
    issn = {0041-3240},
    language = {eng},
    number = {9},
    journal = {Tropical Diseases Bulletin},
    author = {Macdonald, G.},
    month = sep,
    year = {1952},
    pmid = {12995455},
    keywords = {Humans, Malaria, MALARIA},
    pages = {813--829}
}
</textarea>
<div id="bibtex_display"></div>
</body>
</html></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
        <script src="../assets/mathjaxhelper.js"></script>
        <script src="https://cdn.rawgit.com/pcooksey/bibtex-js/ef59e62c/src/bibtex_js.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
